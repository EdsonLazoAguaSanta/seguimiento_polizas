{% extends "base.html" %}

{% block title %}Pólizas{% endblock %}

{% block content %}
<div class="container mt-4">

  <h1 class="mb-3">Pólizas</h1>
  <p class="text-muted">Origen: SharePoint: {{ ruta_base }}</p>

  {% if mensaje %}
    <div class="alert alert-warning">{{ mensaje }}</div>
  {% endif %}

  {% if polizas %}
    <h2 class="h4 mt-4 mb-3">Listado por carpetas</h2>

    <div class="mb-4">
      {% for carpeta in polizas %}
        <details class="mb-2">
          <summary>
            {{ carpeta.carpeta }} ({{ carpeta.cantidad }})
          </summary>
          {% if carpeta.archivos %}
            <ul class="mt-2">
              {% for archivo in carpeta.archivos %}
                <li>
                  <a href="{{ archivo.url }}" target="_blank">
                    {{ archivo.nombre }}
                  </a>
                  {% if archivo.fecha %}
                    <span class="text-muted">– {{ archivo.fecha }}</span>
                  {% endif %}
                </li>
              {% endfor %}
            </ul>
          {% else %}
            <p class="text-muted mt-2 mb-0">No hay archivos en esta carpeta.</p>
          {% endif %}
        </details>
      {% endfor %}
    </div>

  {% else %}
    {% if not mensaje %}
      <div class="alert alert-info">
        No se encontraron pólizas para mostrar.
      </div>
    {% endif %}
  {% endif %}

</div>
{% endblock %}
